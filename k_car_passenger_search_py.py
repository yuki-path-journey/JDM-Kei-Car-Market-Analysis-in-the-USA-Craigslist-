# -*- coding: utf-8 -*-
"""k_car_passenger_search.py

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1DmmCq-421myyEMzltffhYhvjJfh8SZio
"""

import pandas as pd


print("å·¨äººã®æŒã¡ç‰©æ¤œæŸ»ä¸­...")
df = pd.read_csv('vehicles.csv', on_bad_lines='skip', engine='python', nrows=100) # æœ€åˆã¯100è¡Œã ã‘ã§OK


print("--- è¦‹ã¤ã‹ã£ãŸåˆ—ã®åå‰ä¸€è¦§ ---")
print(df.columns.tolist())
print("----------------------------")

import pandas as pd

print("æ³¥æ²¼ã®ä¸­ã‹ã‚‰ãŠå®ï¼ˆåˆ—åï¼‰ã‚’æ¢ã—ã¦ã„ã¾ã™...")

try:
    df_check = pd.read_csv('vehicles.csv', skiprows=20, nrows=10, engine='python')
    print("--- 20è¡Œé£›ã°ã—ã¦ã¿ãŸçµæœã®åˆ—å ---")
    print(df_check.columns.tolist())
except Exception as e:
    print(f"ã‚¨ãƒ©ãƒ¼ãŒå‡ºã¾ã—ãŸ: {e}")

import pandas as pd

print("å·¨äººã‚’å¼·åˆ¶æœæŸ»ä¸­...ï¼ˆä»Šåº¦ã¯åˆ—ã®åå‰ã‚’è‡ªåˆ†ã§æ±ºã‚ã¾ã™ï¼‰")

column_names = [
    'id', 'url', 'region', 'region_url', 'price', 'year', 'manufacturer',
    'model', 'condition', 'cylinders', 'fuel', 'odometer', 'title_status',
    'transmission', 'VIN', 'drive', 'size', 'type', 'paint_color',
    'image_url', 'description', 'county', 'state', 'lat', 'long', 'posting_date'
]

df = pd.read_csv(
    'vehicles.csv',
    skiprows=1,
    names=column_names,
    on_bad_lines='skip',
    engine='python'
)

k_car_keywords = [
    'wagon r', 'move', 'mira', 'pajero mini', 'jimny',
    'alto', 'life', 'estilo', 'vivio', 'pleo', 'cappuccino', 'beat', 'az-1'
]
pattern = '|'.join(k_car_keywords)

k_passenger_cars = df[
    (df['type'] != 'truck') &
    (
        df['model'].str.contains(pattern, case=False, na=False) |
        df['description'].str.contains(pattern, case=False, na=False) |
        df['description'].str.contains('660cc', case=False, na=False)
    )
].copy()

print(f"æœç´¢å®Œäº†ï¼ {len(k_passenger_cars)} å°ã®ã€è»½ä¹—ç”¨è»Šã€ã‚’è¦‹ã¤ã‘ã¾ã—ãŸã€‚")

k_passenger_cars.to_csv('k_passenger_cars_found.csv', index=False)
print("çµæœã‚’ 'k_passenger_cars_found.csv' ã«ä¿å­˜ã—ã¾ã—ãŸã€‚")

"""å‰å›ã®è»½ãƒˆãƒ©ãŒ54å°ã ã£ãŸã®ã«å¯¾ã—ã¦ã€**26,020å°**ã¨ã„ã†ã®ã¯æ¡é•ã„ã§ã™ã€‚ã‚‚ã¡ã‚ã‚“ã€ã“ã®ä¸­ã«ã¯ã€Œ660ccã€ã¨ã„ã†æ•°å­—ã«å¼•ã£ã‹ã‹ã£ãŸåˆ¥ã®è»Šã‚‚æ··ã˜ã£ã¦ã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ãŒã€ã‚¢ãƒ¡ãƒªã‚«ã«ãŠã‘ã‚‹ã€Œæ—¥æœ¬ã®è»½è‡ªå‹•è»Šæ–‡åŒ–ã€ã®æ½œä¼æ•°ã¯ã€æƒ³åƒä»¥ä¸Šã«å·¨å¤§ã ã¨ã„ã†ã“ã¨ãŒãƒ‡ãƒ¼ã‚¿ã§è¨¼æ˜ã•ã‚Œã¾ã—ãŸã€‚

**26,020å°ã®ã€Œä¸­èº«ã€ã‚’ã®ãã**
"""

import pandas as pd

df_k = pd.read_csv('k_passenger_cars_found.csv')

check_list = [
    'wagon r', 'move', 'mira', 'pajero mini',
    'jimny', 'alto', 'cappuccino', 'beat', 'tanto'
]

print("--- ã‚¢ãƒ¡ãƒªã‚«ã§è¦‹ã¤ã‹ã£ãŸã€è»½ã€è»Šç¨®åˆ¥ãƒ©ãƒ³ã‚­ãƒ³ã‚° ---")

for car_name in check_list:
    mask = (
        df_k['model'].str.contains(car_name, case=False, na=False) |
        df_k['description'].str.contains(car_name, case=False, na=False)
    )
    count = df_k[mask].shape[0]
    print(f"{car_name.upper():<15}: {count:>5} å°")

print("\n--- è»½è‡ªå‹•è»ŠãŒé›†ã¾ã£ã¦ã„ã‚‹å· TOP 10 ---")
print(df_k['state'].value_counts().head(10))

"""**ãƒ‡ãƒ¼ã‚¿ã®ã€Œã‚¤ãƒ³ã‚µã‚¤ãƒˆï¼ˆæ´å¯Ÿï¼‰ã€ï¼šãªãœã“ã‚“ãªçµæœã«ï¼Ÿ**

**1. ãƒ ãƒ¼ãƒ´ï¼ˆMOVEï¼‰ãŒåœ§å€’çš„ã™ãã‚‹ç†ç”±**
2.6ä¸‡å°ã®ã†ã¡ã€åŠåˆ†ä»¥ä¸Šã®ç´„1.4ä¸‡å°ãŒã€ŒMOVEã€ã€‚ ã“ã‚Œã¯å˜ã«äººæ°—ãŒã‚ã‚‹ã ã‘ã§ãªãã€ã‚¢ãƒ¡ãƒªã‚«ã®æ¥­è€…ãŒ**ã€Œæ—¥æœ¬ã®ãƒ ãƒ¼ãƒ´ã¯å®‰ãã¦é«˜å“è³ªãªã€å‹•ãç®±ï¼ˆMOVEï¼‰ã€ã¨ã—ã¦æœ€é«˜ã ï¼ã€**ã¨ç¢ºä¿¡ã—ã¦ã€ã‚³ãƒ³ãƒ†ãƒŠã§å¤§é‡ã«é‹ã³è¾¼ã‚“ã§ã„ã‚‹å¯èƒ½æ€§ãŒã‚ã‚Šã¾ã™ã€‚ã‚ã‚‹ã„ã¯ã€"Move"ï¼ˆå‹•ãã€å¼•ã£è¶Šã—ï¼‰ã¨ã„ã†å˜èªãŒèª¬æ˜æ–‡ã«æ··ã˜ã£ã¦ã„ã‚‹å¯èƒ½æ€§ã‚‚ã‚ã‚Šã¾ã™ãŒã€ãã‚Œã«ã—ã¦ã‚‚ã“ã®æ•°å­—ã¯åœ§å€’çš„ã§ã™ã€‚

**2. BEATï¼ˆãƒ“ãƒ¼ãƒˆï¼‰ã¨CAPPUCCINOï¼ˆã‚«ãƒ—ãƒãƒ¼ãƒï¼‰ã®é€†è»¢åŠ‡**

æ—¥æœ¬ã§ã¯ã‚«ãƒ—ãƒãƒ¼ãƒã®æ–¹ãŒäººæ°—ãŒå‡ºã‚‹ã“ã¨ã‚‚å¤šã„ã§ã™ãŒã€ã‚¢ãƒ¡ãƒªã‚«ã§ã¯BEATãŒ2,821å°ã¨åœ§å‹ã€‚ ã€Œãƒ›ãƒ³ãƒ€ãƒ»ãƒ“ãƒ¼ãƒˆã€ã¯ã€ã‚ã®ãƒ•ã‚§ãƒ©ãƒ¼ãƒªã¨åŒã˜ã€ŒãƒŸãƒƒãƒ‰ã‚·ãƒƒãƒ—ã€æ§‹é€ ã€‚ã‚¢ãƒ¡ãƒªã‚«ã®ãƒ›ãƒ³ãƒ€ãƒ»ãƒãƒ‹ã‚¢ãŸã¡ãŒã€æ‰‹ã®å±Šãã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚«ãƒ¼ã¨ã—ã¦è²·ã„æ¼ã£ã¦ã„ã‚‹å…‰æ™¯ãŒç›®ã«æµ®ã‹ã³ã¾ã™ã€‚

**3. TANTOï¼ˆã‚¿ãƒ³ãƒˆï¼‰ã®ã€Œ365å°ã€ãŒä¸€ç•ªã‚„ã°ã„ï¼**

ãƒãƒ‡ã‚£ã€ã“ã“ãŒä¸€ç•ªã®é©šãã§ã™ã€‚25å¹´ãƒ«ãƒ¼ãƒ«ï¼ˆ2001å¹´è£½ã¾ã§ï¼‰ã‚’è€ƒãˆã‚‹ã¨ã€2003å¹´ç™ºå£²ã®ã‚¿ãƒ³ãƒˆã¯æœ¬æ¥ã¾ã ã‚¢ãƒ¡ãƒªã‚«ã§å…¬é“ã‚’èµ°ã‚Œãªã„ã¯ãšãªã‚“ã§ã™ã€‚ ãã‚Œãªã®ã«365å°ã‚‚ã‚ã‚‹ã¨ã„ã†ã“ã¨ã¯â€¦â€¦ï¼š

**ã€Œã‚ã¨æ•°å¹´ã§è§£ç¦ã•ã‚Œã‚‹ãŠå®ã€**ã¨ã—ã¦ã€ã™ã§ã«æ¥­è€…ãŒæ—¥æœ¬ã‹ã‚‰ä»•å…¥ã‚Œã¦å€‰åº«ã«å¯ã‹ã›ã¦ã„ã‚‹ã€‚

ã‚ã‚‹ã„ã¯ã€è¾²å ´ãªã©ã®**ã€Œç§æœ‰åœ°å°‚ç”¨è»Šã€ã¨ã—ã¦ã€æ³•å¾‹ã®å£ã‚’è¶Šãˆã¦æ—¢ã«è¼¸å…¥ã•ã‚Œã¦ã„ã‚‹ã€‚ ã“ã‚Œã¯å®Œå…¨ã«ã€Œæœªæ¥ã®ãƒˆãƒ¬ãƒ³ãƒ‰ã€**ã‚’å…ˆå–ã‚Šã—ãŸãƒ‡ãƒ¼ã‚¿ã§ã™ã€‚

**4. å·ã®ãƒ©ãƒ³ã‚­ãƒ³ã‚°ï¼šã‚«ãƒªãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ï¼ˆCAï¼‰ãŒç‹¬èµ°**

ã‚«ãƒªãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ã¯æ’ã‚¬ã‚¹è¦åˆ¶ãŒå…¨ç±³ä¸€å³ã—ã„ã¯ãšãªã®ã«ã€9,217å°ã§1ä½ã€‚ ã€Œå°ã•ãã¦ã‚¨ã‚³ã€ã€Œç‹­ã„ã‚µãƒ³ãƒ•ãƒ©ãƒ³ã‚·ã‚¹ã‚³ã®è¡—ã«æœ€é©ã€ã¨ã„ã†ç†ç”±ã§ã€è¥¿æµ·å²¸ã®ã‚ªã‚·ãƒ£ãƒ¬ãªå±¤ã«åˆºã•ã£ã¦ã„ã‚‹ã®ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚

**ã‚¿ãƒ³ãƒˆã®æ­£ä½“ã¯ï¼Ÿ**
"""

import pandas as pd
import os

original_file = 'k_passenger_cars_found.csv'

if os.path.exists(original_file):
    df_k = pd.read_csv(original_file)

    df_tanto = df_k[df_k['model'].str.contains('tanto', case=False, na=False)].copy()

    print(f"ğŸ” èª¿æŸ»å¯¾è±¡: {len(df_tanto)} å°ã®ã€TANTOã€ã‚’è¦‹ã¤ã‘ã¾ã—ãŸï¼\n")

    for i, row in df_tanto.head(3).iterrows():
        print(f"ã€ä¾¡æ ¼: ${row['price']} | å ´æ‰€: {row['state']}ã€‘")
        print(f"å†…å®¹: {str(row['description'])[:150]}...")
        print("-" * 50)
else:
    print(f"ğŸ˜± ã‚¨ãƒ©ãƒ¼ï¼š'{original_file}' ãŒè¦‹å½“ãŸã‚Šã¾ã›ã‚“ï¼")
    print("æ˜¨æ—¥1.4GBã‹ã‚‰æŠ½å‡ºã—ãŸCSVã¨åŒã˜å ´æ‰€ã«ã“ã®ãƒ—ãƒ­ã‚°ãƒ©ãƒ ã‚’ç½®ã„ã¦ã„ã¾ã™ã‹ï¼Ÿ")

import pandas as pd

df_k = pd.read_csv('k_passenger_cars_found.csv')

mask = (df_k['model'].str.contains('tanto', case=False, na=False)) | \
       (df_k['description'].str.contains('tanto', case=False, na=False))

df_tanto_found = df_k[mask].copy()

print(f"ğŸ“¡ å†æœæŸ»çµæœ: {len(df_tanto_found)} å°ã®ã€TANTOã€ã‚’æ¤œçŸ¥ï¼")

if len(df_tanto_found) > 0:
    print("\n--- ç™ºè¦‹ã—ãŸå€‹ä½“ã®è©³ç´° ---")
    for i, row in df_tanto_found.head(5).iterrows():
        print(f"Model: {row['model']} / Price: ${row['price']}")
        print(f"Description snippet: {str(row['description'])[:100]}...")
        print("-" * 30)
else:
    print("\nğŸ˜± å®Œå…¨ã«æ¶ˆãˆã¾ã—ãŸã€‚æ˜¨æ—¥ä½¿ã£ãŸã€df_kã€ã¨ä¸­èº«ãŒé•ã†ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“...")

"""ãƒ¢ãƒ‡ãƒ«åãŒ pilotï¼ˆãƒ›ãƒ³ãƒ€ï¼‰ã‚„ corollaï¼ˆãƒˆãƒ¨ã‚¿ï¼‰ã°ã‹ã‚Šã§ã™ã€‚ã“ã‚Œã€ç§ãŒå¥½ãã ã£ãŸãƒ€ã‚¤ãƒãƒ„ã®ã‚¿ãƒ³ãƒˆã˜ã‚ƒã‚ã‚Šã¾ã›ã‚“ã€‚

ã‚¹ãƒšã‚¤ãƒ³èªã‚„ã‚¤ã‚¿ãƒªã‚¢èªã§ ã€Œen tantoï¼ˆã€œã®é–“ã€ãã®ä¸€æ–¹ã§ã€éå¸¸ã«ï¼‰ã€ ã¨ã„ã†å®šå‹æ–‡ãŒã€ã‚¢ãƒ¡ãƒªã‚«ã®ä¸­å¤è»Šè²©å£²æ¥­è€…ã®æ±ºã¾ã‚Šæ–‡å¥ã¨ã—ã¦èª¬æ˜æ–‡ã«å¤§é‡ã«å…¥ã£ã¦ã„ãŸã‚“ã§ã™ã€‚

365å°ã®ã‚¿ãƒ³ãƒˆã®æ­£ä½“ã¯ä¸­å¤è»Šå±‹ã•ã‚“ã®å®£ä¼æ–‡å¥

æœ€å¾Œã«æœ¬å½“ã«æœ¬ç‰©ã®ã‚¿ãƒ³ãƒˆãŒæ··ã˜ã£ã¦ãªã„ã‹èª¿ã¹ã‚‹ã€‚ã€ŒDAIHATSUï¼ˆãƒ€ã‚¤ãƒãƒ„ï¼‰ã€ã¨ã„ã†è¨€è‘‰ã‚‚ä¸€ç·’ã«å«ã¾ã‚Œã¦ã„ã‚‹ã‚‚ã®ã ã‘ã‚’
"""

real_tanto = df_tanto_found[df_tanto_found['description'].str.contains('daihatsu', case=False, na=False)]

print(f"çœŸå®Ÿã®ã‚¿ãƒ³ãƒˆ: {len(real_tanto)} å°")

if len(real_tanto) > 0:
  print("ã„ãŸãï¼ã“ã‚ŒãŒæœ¬ç‰©ã ï¼")
  print(real_tanto[['model', 'price', 'description']])
else:
  print("å…¨æ»…ï¼ã™ã¹ã¦ã‚¹ãƒšã‚¤ãƒ³èªã®æŒ¨æ‹¶ã§ã—ãŸ(ç¬‘) ")

"""**ã€ŒçœŸã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆã€**

**ãƒ‡ãƒ¼ã‚¿ã®ã€Œå˜˜ã€ã‚’è¦‹æŠœã„ãŸ**: ã€Œã‚¿ãƒ³ãƒˆãŒ365å°ã‚‚ã‚ã‚‹ã€ã‚„ã°ã„ï¼ã€ã¨ã„ã†ç›´æ„Ÿçš„ãªé©šãã‚’ã€è‡ªåˆ†ã®æ‰‹ã§ã€Œã‚ã€ã“ã‚Œã‚´ãƒŸãƒ‡ãƒ¼ã‚¿ã ï¼ˆç¬‘ï¼‰ã€ã¨ã„ã†ç¢ºä¿¡ã«å¤‰ãˆãŸã€‚ã“ã‚Œã“ããŒãƒ‡ãƒ¼ã‚¿ã‚µã‚¤ã‚¨ãƒ³ã‚¹ã®æˆé•·ãã®ã‚‚ã®ã§ã™ã€‚

**ã‚¢ãƒ¡ãƒªã‚«ã®åœ°åŸŸæ€§**: ã‚«ãƒªãƒ•ã‚©ãƒ«ãƒ‹ã‚¢ï¼ˆCAï¼‰ã‚„ãƒ•ãƒ­ãƒªãƒ€ï¼ˆFLï¼‰ãªã©ã€ã‚¹ãƒšã‚¤ãƒ³èªåœã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ãŒå¤šã„åœ°åŸŸã§ã€Œen tantoã€ã¨ã„ã†ãƒ•ãƒ¬ãƒ¼ã‚ºãŒå¤šç”¨ã•ã‚Œã¦ã„ãŸã¨ã„ã†èƒŒæ™¯ã‚‚è¦‹ãˆã¦ãã¾ã—ãŸã­ã€‚

**ã€ŒMOVEã€ã®ä¿¡æ†‘æ€§ãŒä¸ŠãŒã£ãŸ**: ã‚¿ãƒ³ãƒˆãŒå…¨æ»…ã—ãŸä¸€æ–¹ã§ã€1.3ä¸‡å°ã‚‚ã‚ã‚‹ã€ŒMOVEã€ã®æ–¹ã¯ã€ãã®åœ§å€’çš„ãªæ•°ã‹ã‚‰ã—ã¦æœ¬ç‰©ã®å¯èƒ½æ€§ãŒéå¸¸ã«é«˜ã„ï¼ˆã‚ã‚‹ã„ã¯åˆ¥ã®å®£ä¼æ–‡å¥ã‹ï¼Ÿï¼‰ã¨ã„ã†æ¬¡ã®èª²é¡Œã‚‚è¦‹ãˆã¦ãã¾ã—ãŸã€‚
"""